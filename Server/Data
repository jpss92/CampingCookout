const fs = require('fs');
const pdf = require('pdf-parse');

const pdfBuffer = fs.readFileSync('./PDFs/500+ camping recipes.pdf');

async function extractTextFromPDF(pdfBuffer) {
    const data = await pdf(pdfBuffer);
    return data.text;
}

function structuredRecipes(text) {
    const recipes = [];
    const recipeChunks = text.split('~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~');

    recipeChunks.forEach((recipeChunk) => {
        const recipeLines =recipeChunk.trim().split('\n');
        const title = recipeLines[0].trim();
        const ingredients = recipeLines.slice(1, recipeLines.indexOf('Instructions:')).map((line) => line.trim());
        const instructions = recipeLines.slice(recipeLines.indexOF('Instructions:') + 1).map((line) => line.trim());

        recipes.push({ title, ingredients, instructions });
    });

    return recipes;
}

async function main() {
    try {
        const pdfText = await extractTextFromPDF(pdfBuffer);
        const recipes = structuredRecipes(pdfText);

    } catch (error) {
        console.error('An Error has occured:', error);
    }
}

main();